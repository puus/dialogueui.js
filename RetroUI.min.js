var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype;e.prototype=new n};var Box=function(){function e(e,t,n,r){this.name=e;this.width=t;this.height=n;this.flavour=r;this.hidden=false;this.initMarkup();this.initCss()}e.prototype.initMarkup=function(){this.rootElement=document.createElement("section");this.rootElement.setAttribute("id",this.name);this.rootElement.setAttribute("class","box "+this.flavour);var e=document.createElement("div");e.setAttribute("class","border1");this.rootElement.appendChild(e);e=document.createElement("div");e.setAttribute("class","content");this.rootElement.appendChild(e)};e.prototype.initCss=function(){this.borderWidth=this.width-.45;this.borderHeight=this.height-.4;this.contentWidth=this.width-.7;this.contentHeight=this.height-.65;var e="#"+this.name+" {"+"display: block;"+"width: "+this.width+"em;"+"height: "+this.height+"em;} ";var t="#"+this.name+" .border1 {"+"width: "+this.borderWidth+"em;"+"height: "+this.borderHeight+"em;} ";var n="#"+this.name+" .content {"+"width: "+this.contentWidth+"em;"+"height: "+this.contentHeight+"em;} ";var r="#"+this.name+" {"+"display: none;"+"}";var i="";if(this.hidden==true){i+=t+n+r}else{i+=e+t+n}this.css=document.createElement("style");this.css.setAttribute("type","text/css");this.css.appendChild(document.createTextNode(i));document.getElementsByTagName("head")[0].appendChild(this.css)};e.prototype.GetName=function(){return this.name};e.prototype.GetWidth=function(){return this.width};e.prototype.GetHeight=function(){return this.height};e.prototype.GetRootElement=function(){return this.rootElement};e.prototype.GetCss=function(){return this.css};e.prototype.getFlavour=function(){return this.flavour};e.prototype.SetWidth=function(e){this.width=e;this.initCss()};e.prototype.SetHeight=function(e){this.height=e;this.initCss()};e.prototype.SetDimensions=function(e,t){this.width=e;this.height=t;this.initCss()};e.prototype.Hide=function(){this.hidden=true;this.initCss()};e.prototype.Show=function(){this.hidden=false;this.initCss()};e.prototype.SetFlavour=function(e){this.flavour=e;var t=this.rootElement.getAttribute("class");var n="";var r=t.split(" ");for(var i=0;i<r.length;i++){if(r[i].trim()!="plain"&&r[i].trim()!="mint"&&r[i].trim()!="strawberry"&&r[i].trim()!="banana"&&r[i].trim()!="penut"){n+=r[i]+" "}}n+=this.flavour;this.rootElement.setAttribute("class",n)};return e}();var DisplayBox=function(e){function t(t,n,r,i,s){this.title=s;e.call(this,t,n,r,i);this._initMarkup()}__extends(t,e);t.prototype._initMarkup=function(){if(typeof this.title!="undefined"&&this.title!=""){var e=document.createElement("h1");e.setAttribute("class","displayBoxHeading");e.appendChild(document.createTextNode(this.title));this.GetRootElement().getElementsByClassName("content")[0].appendChild(e)}};t.prototype.HasH1=function(){if(typeof this.GetRootElement().getElementsByTagName("h1")[0]!="undefined"){return true}else{return false}};t.prototype.GetTitle=function(){return this.title};t.prototype.SetTitle=function(e){this.title=e;var t=this.GetRootElement().getElementsByClassName("content")[0];if(this.HasH1()){this.GetRootElement().getElementsByClassName("displayBoxHeading")[0].textContent=e}else{var n=document.createElement("h1");n.setAttribute("class","displayBoxHeading");if(t.hasChildNodes()){t.firstChild.insertBefore(n)}else{t.appendChild(n)}}};return t}(Box);var SelectionBox=function(e){function t(t,n,r,i,s,o,u){e.call(this,t,n,r,i,s);this.optionsIndex=0;this.currentIndex=0;if(u){this.currentIndex=u}this.__initMarkup();if(typeof o==="undefined"){this.options=new Array}else{this.options=o;this.optionsIndex=o.length;this.updateUlMarkup()}}__extends(t,e);t.prototype.__initMarkup=function(){var e=document.createElement("img");var t=document.createElement("ul");e.setAttribute("class","cursor");e.setAttribute("src","img/cursor.gif");t.setAttribute("class","selectionList");this.GetRootElement().getElementsByClassName("content")[0].appendChild(e);this.GetRootElement().getElementsByClassName("content")[0].appendChild(t);this.updateCursorPosition()};t.prototype.HasUl=function(){for(var e;e<this.GetRootElement().childNodes.length;e++){if(this.GetRootElement().childNodes[e].nodeName=="ul"){return true}}return false};t.prototype.AddOption=function(e){this.options[this.optionsIndex]=e;this.updateUlMarkup();this.optionsIndex++};t.prototype.RemoveOption=function(e){this.options.splice(e,1);this.updateUlMarkup()};t.prototype.GetOption=function(e){return this.options[e]};t.prototype.setOption=function(e,t){this.options[e]=t;this.updateUlMarkup()};t.prototype.GetCurrentOption=function(){return this.options[this.currentIndex]};t.prototype.GetCurrentIndex=function(){return this.currentIndex};t.prototype.SetCurrentIndex=function(e){this.currentIndex=e;this.updateCursorPosition()};t.prototype.Up=function(){this.decCurrentIndex()};t.prototype.Down=function(){this.incCurrentIndex()};t.prototype.incCurrentIndex=function(){if(this.currentIndex==this.options.length-1){this.currentIndex=0;this.updateCursorPosition();return}this.currentIndex++;this.updateCursorPosition()};t.prototype.decCurrentIndex=function(){if(this.currentIndex==0){this.currentIndex=this.options.length-1;this.updateCursorPosition();return}this.currentIndex--;this.updateCursorPosition()};t.prototype.ConfirmSelection=function(e){var t=this.GetRootElement().getElementsByClassName(this.currentIndex.toString())[0];t.attributes[0].value+=" confirm";var n=this.GetRootElement().getElementsByClassName("cursor")[0];var r=this.GetRootElement().getElementsByClassName("content")[0];r.removeChild(n);if(typeof e!="undefined"){e()}};t.prototype.updateCursorPosition=function(){var e=this.GetRootElement().getElementsByClassName("cursor")[0];var t=1.2;if(this.HasH1()){t+=2.3}if(this.currentIndex!=0){t+=this.currentIndex*1.9}var n=document.createElement("style");n.setAttribute("type","text/css");n.appendChild(document.createTextNode("#"+this.GetName()+" .content .cursor {top:"+t+"em;}"));document.getElementsByTagName("head")[0].appendChild(n)};t.prototype.updateUlMarkup=function(){var e=this.GetRootElement().getElementsByClassName("selectionList")[0];if(e.hasChildNodes()){while(e.firstChild){e.removeChild(e.firstChild)}}for(var t=0;t<this.options.length;t++){var n=document.createElement("li");n.setAttribute("class",t.toString());n.innerHTML=this.options[t];e.appendChild(n)}};return t}(DisplayBox);var NameBox=function(e){function t(t,n,r,i){e.call(this,t,n,r,i);this.playerName="";this._initMarkup()}__extends(t,e);t.prototype._initMarkup=function(){for(var e=1;e<6;e++){var t=document.createElement("span");var n="";if(e==this.playerName.length+1||e==1&&this.playerName.length==0){n+=" active";if(e==1){n+=" first"}}else if(e==1){n+=" first"}else if(e==5){n+=" last"}if(e!=this.playerName.length+1){if(this.playerName.charAt(e-1)!=""){t.innerHTML=this.playerName.charAt(e-1)}else{t.innerHTML="—"}}t.setAttribute("class",n+" "+e.toString());this.GetRootElement().getElementsByClassName("content")[0].appendChild(t)}};t.prototype.SetName=function(e){this.playerName=e;this.update()};t.prototype.EnterChar=function(e){if(e.length!=1){return}if(this.playerName.length<5){this.playerName+=e}this.update()};t.prototype.Backspace=function(){if(this.playerName.length>0){this.playerName=this.playerName.slice(0,this.playerName.length-1)}this.update()};t.prototype.GetPlayerName=function(){return this.playerName};t.prototype.update=function(){var e=new Array;for(var t=0;t<this.playerName.length-1;t++){e[t]=this.playerName.charAt(t)}var n=this.GetRootElement().getElementsByClassName("content")[0];while(n.hasChildNodes()){n.removeChild(n.firstChild)}this._initMarkup()};return t}(Box);var TypeBox=function(e){function t(t,n,r){e.call(this,t,32.15,16.6,n);this.nameBox=r;this.options=new Array;this.optionsCursorMapping=new Array;this.currentPosition=[0,0];this.caps=true;this.options=[["A","B","C","D","E","F","G","H","I","-",","],["J","K","L","M","N","O","P","Q","R","'","~"],["S","T","U","V","W","X","Y","Z",".","/"],["0","1","2","3","4","5","6","7","8","9","!","#"],["CAPITAL","small","?","%"],["Dont care","Backspace","OK"]];this.optionsCursorMapping=[[[1.15,.8],[1.15,3.1],[1.15,5.3],[1.15,7.5],[1.15,9.7],[1.15,12],[1.15,14.3],[1.15,16.6],[1.15,18.9],[1.15,25.5],[1.15,28.1]],[[3.7,.8],[3.7,3.1],[3.7,5.3],[3.7,7.5],[3.7,9.7],[3.7,12],[3.7,14.3],[3.7,16.6],[3.7,18.9],[3.7,25.5],[3.7,28.1]],[[6.2,.8],[6.2,3.1],[6.2,5.3],[6.2,7.5],[6.2,9.7],[6.2,12],[6.2,14.3],[6.2,16.6],[6.2,25.5],[6.2,28.1]],[[8.7,.8],[8.7,3.1],[8.7,5.3],[8.7,7.5],[8.7,9.7],[8.7,12],[8.7,14.3],[8.7,16.6],[8.7,18.9],[8.7,21.2],[8.7,25.5],[8.7,28.1]],[[11.1,.8],[11.1,9.7],[11.1,25.5],[11.1,28.1]],[[13.6,.8],[13.6,16.6],[13.6,28.1]]];this._initMarkup();this._initCss()}__extends(t,e);t.prototype._initMarkup=function(){var e=document.createElement("img");e.setAttribute("src","img/cursor.gif");var t=document.createElement("table");t.setAttribute("class","typeTable");for(var n=0;n<this.options.length;n++){var r=document.createElement("tr");for(var i=0;i<this.options[n].length;i++){var s=document.createElement("td");if((n==0||n==1)&&i==8){s.setAttribute("colspan","3")}else if(n==2&&i==7){s.setAttribute("colspan","4")}else if(n==4&&i==0){s.setAttribute("colspan","4")}else if(n==4&&i==1){s.setAttribute("colspan","7")}else if(n==5&&i==0){s.setAttribute("colspan","7")}else if(n==5&&i==1){s.setAttribute("colspan","5")}if(n<3){if(this.caps){s.innerHTML=this.options[n][i].toUpperCase()}else{s.innerHTML=this.options[n][i].toLowerCase()}}else{s.innerHTML=this.options[n][i]}r.appendChild(s);if(n==3&&i==9){var o=document.createElement("td");r.appendChild(o)}}t.appendChild(r)}this.GetRootElement().getElementsByClassName("content")[0].appendChild(e);this.GetRootElement().getElementsByClassName("content")[0].appendChild(t)};t.prototype._reinitMarkup=function(){this.GetRootElement().getElementsByClassName("content")[0].removeChild(this.GetRootElement().getElementsByClassName("typeTable")[0]);this._initMarkup()};t.prototype._initCss=function(){var e=document.createElement("style");e.setAttribute("type","text/css");e.appendChild(document.createTextNode("#"+this.GetName()+" .content table {"+"width: 100%;"+"height: 100%;"+"padding: .5em 1.5em .5em 1.5em;"+"}"+"#"+this.GetName()+" .content table td {"+"width: 8.33%;"+"}"+"#"+this.GetName()+" .content {"+"position: relative;"+"}"+"#"+this.GetName()+" .content img {"+"position: absolute;"+"top: 1.15em; left: .8em;"+"}"));document.getElementsByTagName("head")[0].appendChild(e)};t.prototype.update=function(){var e=this.optionsCursorMapping[this.currentPosition[0]];var t=e[this.currentPosition[1]][0];var n=e[this.currentPosition[1]][1];var r=document.createElement("style");r.setAttribute("type","text/css");r.appendChild(document.createTextNode("#"+this.GetName()+" .content img {"+"position: absolute;"+"top: "+t+"em; left:"+n+"em;"+"}"));document.getElementsByTagName("head")[0].appendChild(r)};t.prototype.SetPosition=function(e,t){this.currentPosition[0]=e;this.currentPosition[1]=t;this.update()};t.prototype.Up=function(){if(this.currentPosition[0]==3&&this.currentPosition[1]==8){this.currentPosition[0]=1}else if(this.currentPosition[0]==4&&this.currentPosition[1]==1){this.currentPosition[0]=3;this.currentPosition[1]=4}else if(this.currentPosition[0]==5&&this.currentPosition[1]==2){this.currentPosition[0]=4;this.currentPosition[1]=3}else if(this.currentPosition[0]==4&&this.currentPosition[1]==3){this.currentPosition[0]=3;this.currentPosition[1]=11}else if(this.currentPosition[0]==3&&this.currentPosition[1]==11){this.currentPosition[0]=2;this.currentPosition[1]=9}else if(this.currentPosition[0]==2&&this.currentPosition[1]==9){this.currentPosition[0]=1;this.currentPosition[1]=10}else if(this.currentPosition[0]==4&&this.currentPosition[1]==2){this.currentPosition[0]=3;this.currentPosition[1]=10}else if(this.currentPosition[0]==3&&this.currentPosition[1]==10){this.currentPosition[0]=2;this.currentPosition[1]=8}else if(this.currentPosition[0]==2&&this.currentPosition[1]==8){this.currentPosition[0]=1;this.currentPosition[1]=9}else if(this.currentPosition[0]==3&&this.currentPosition[1]==9){this.currentPosition[0]=1;this.currentPosition[1]=8}else{if(this.currentPosition[0]>0){this.currentPosition[0]--}else{this.currentPosition[0]=5}}this.update()};t.prototype.Down=function(){if(this.currentPosition[0]==1&&this.currentPosition[1]==8){this.currentPosition[0]=3}else if(this.currentPosition[0]==3&&this.currentPosition[1]<4){this.currentPosition[0]=4;this.currentPosition[1]=0}else if(this.currentPosition[0]==3&&this.currentPosition[1]>=4&&this.currentPosition[1]<7){this.currentPosition[0]=4;this.currentPosition[1]=1}else if(this.currentPosition[0]==3&&this.currentPosition[1]>=7&&this.currentPosition[1]<10){this.currentPosition[0]=5;this.currentPosition[1]=1}else if(this.currentPosition[0]==1&&this.currentPosition[1]==9){this.currentPosition[0]=2;this.currentPosition[1]=8}else if(this.currentPosition[0]==1&&this.currentPosition[1]==10){this.currentPosition[0]=2;this.currentPosition[1]=9}else if(this.currentPosition[0]==2&&this.currentPosition[1]==8){this.currentPosition[0]=3;this.currentPosition[1]=10}else if(this.currentPosition[0]==2&&this.currentPosition[1]==9){this.currentPosition[0]=3;this.currentPosition[1]=11}else if(this.currentPosition[0]==3&&this.currentPosition[1]==10){this.currentPosition[0]=4;this.currentPosition[1]=2}else if(this.currentPosition[0]==3&&this.currentPosition[1]==11){this.currentPosition[0]=4;this.currentPosition[1]=3}else if(this.currentPosition[0]==4&&this.currentPosition[1]==3){this.currentPosition[0]=5;this.currentPosition[1]=2}else{if(this.currentPosition[0]<5){this.currentPosition[0]++}else{this.currentPosition[0]=0}}this.update()};t.prototype.Left=function(){if(this.currentPosition[1]>0){this.currentPosition[1]--}else{this.currentPosition[1]=this.options[this.currentPosition[0]].length-1}this.update()};t.prototype.Right=function(){if(this.currentPosition[1]<this.options[this.currentPosition[0]].length-1){this.currentPosition[1]++}else{this.currentPosition[1]=0}this.update()};t.prototype.ConfirmSelection=function(e){var t=this.options[this.currentPosition[0]][this.currentPosition[1]];switch(t){case"CAPITAL":this.caps=true;this._reinitMarkup();break;case"small":this.caps=false;this._reinitMarkup();break}if(this.caps){t=t.toUpperCase()}else{t=t.toLowerCase()}if(typeof e!="undefined"){e(t)}};return t}(Box)